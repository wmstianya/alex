# STM32火焰检测系统 - 自适应算法 V1.0.3

## 概述
本版本实现了智能自适应火焰检测算法，能够自动学习环境基线，动态调整检测阈值，显著提高检测精度和稳定性。

## 核心特性

### 1. 智能基线校准
- **自动学习**：系统启动时自动采集50个样本学习环境基线
- **范围限制**：基线值限制在500-3000mV安全范围内
- **定期更新**：运行中每5秒在稳定条件下自动重新校准

### 2. 动态阈值调整
- **自适应阈值**：检测阈值 = 环境基线 - 300mV
- **环境适应**：根据环境变化自动调整，无需手动设置
- **智能跟踪**：长期跟踪环境变化趋势

### 3. 多条件检测算法
- **阈值检测**：当前值低于动态阈值
- **梯度检测**：检测大幅下降(>50mV/采样)
- **相对变化**：相对基线变化超过8%时触发

### 4. 防误触发机制
- **连续确认**：需要连续3次检测确认才判定为火焰
- **噪声滤除**：有效过滤环境干扰和测量噪声
- **稳定输出**：避免频繁开关输出

### 5. 增强显示功能
- **实时显示**：正常显示当前电压值
- **基线指示**：每5秒显示1秒基线值用于监控
- **校准提示**：校准期间显示当前采样值

## 技术参数

| 参数 | 数值 | 说明 |
|------|------|------|
| 基线校准样本数 | 50 | 启动时学习样本数量 |
| 基线范围 | 500-3000mV | 安全工作范围 |
| 动态阈值偏移 | 300mV | 基线下方偏移量 |
| 梯度阈值 | 50mV/采样 | 快速变化检测 |
| 相对变化阈值 | 8% | 相对基线变化百分比 |
| 确认次数 | 3次 | 防误触发确认数 |
| 基线更新间隔 | 5000ms | 定期重新校准 |

## 工作流程

1. **系统启动** → 初始化自适应检测器
2. **基线校准** → 采集50个样本学习环境基线(约2秒)
3. **实时检测** → 多条件并行检测算法
4. **结果确认** → 连续3次确认防止误触发
5. **基线维护** → 定期在稳定条件下更新基线

## 优势对比

### 传统固定阈值 vs 自适应算法

| 特性 | 固定阈值 | 自适应算法 |
|------|----------|------------|
| 环境适应性 | ❌ 需手动调整 | ✅ 自动适应 |
| 检测精度 | ⚠️ 环境变化影响大 | ✅ 高精度稳定 |
| 误触发率 | ⚠️ 较高 | ✅ 极低 |
| 安装便利性 | ❌ 需现场调试 | ✅ 即插即用 |
| 长期稳定性 | ❌ 需定期校准 | ✅ 自动维护 |

## 使用说明

1. **上电启动**：系统自动进入2秒校准模式
2. **正常运行**：显示当前电压值，每5秒短暂显示基线值
3. **火焰检测**：LED点亮、继电器吸合表示检测到火焰
4. **无需调试**：算法自动适应各种安装环境

## 版本历史

- **V1.0.1** (2025.02.19)：基础固定阈值检测
- **V1.0.2** (2025.03.31)：优化阈值和延时参数  
- **V1.0.3** (2025.01.11)：**实现完整自适应检测算法**

## 技术支持

如有疑问或需要技术支持，请联系开发团队。 